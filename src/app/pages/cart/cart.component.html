<div class="cart-container" *ngIf="items.length > 0; else emptyCart">
  <h2>My Cart</h2>

  <!-- Desktop -->
  <div class="cart-table-wrapper desktop-only">
    <table class="cart-table">
      <thead>
        <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Subtotal</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let item of items">
          <td class="product-info">
            <img
              [src]="item.product.imageUrl || 'assets/images/placeholder.png'"
              alt="{{ item.product.name }}"
              class="product-img"
            />
            <div class="product-details">
              <p class="name">{{ item.product.name }}</p>
              <p class="category" *ngIf="item.product.category">
                {{ item.product.category }}
              </p>
            </div>
          </td>
          <td class="price">
            {{ item.product.price | currency }}
          </td>
          <td class="quantity">
            <input
              type="number"
              min="1"
              [value]="item.quantity"
              (change)="changeQuantity(item.product.id, +$event.target.value)"
            />
          </td>
          <td class="subtotal">
            {{ item.quantity * item.product.price | currency }}
          </td>
          <td class="actions">
            <button mat-icon-button color="warn" (click)="removeItem(item.product.id)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mobile -->
  <div class="mobile-only">
    <div class="cart-card" *ngFor="let item of items">
      <div class="card-header">
        <img
          [src]="item.product.imageUrl || 'assets/images/placeholder.png'"
          alt="{{ item.product.name }}"
          class="mobile-img"
        />
        <div class="info">
          <h3>{{ item.product.name }}</h3>
          <p *ngIf="item.product.category">{{ item.product.category }}</p>
        </div>
      </div>

      <div class="card-body">
        <p><strong>Price:</strong> {{ item.product.price | currency }}</p>

        <div class="quantity-row">
          <label><strong>Quantity:</strong></label>
          <input
            type="number"
            min="1"
            [value]="item.quantity"
            (change)="changeQuantity(item.product.id, +$event.target.value)"
          />
        </div>

        <p><strong>Subtotal:</strong> {{ item.quantity * item.product.price | currency }}</p>
      </div>

      <div class="card-actions">
        <button
          mat-icon-button
          color="warn"
          (click)="removeItem(item.product.id)"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="cart-summary">
    <p><strong>Total:</strong> {{ getTotal() | currency }}</p>
    <div class="buttons">
      <button mat-stroked-button color="primary" (click)="clearCart()">
        Empty Cart
      </button>
      <button mat-flat-button color="primary" (click)="checkout()">
        To Payment
      </button>
    </div>
  </div>
</div>

<ng-template #emptyCart>
  <div class="empty-cart">
    <p>Your Cart is empty</p>
    <button mat-raised-button color="primary" routerLink="/catalog">
      Back to Catalog
    </button>
  </div>
</ng-template>